<script>
$(function () {
  $('#container3').highcharts({
    chart: { type: 'spline' },
    title: {
      text: '<%= @infos_data[0]["country"] %>'
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: { year: '%Y' },
      title: { text: 'Year' }
    },
    yAxis: [{
      title: {
        text: '<%= @infos_data[0]["title"] %>',
        style: {
          color: Highcharts.getOptions().colors[0]
        }
      },
      labels: {
        style: {
          color: Highcharts.getOptions().colors[0]
        }
      },
    }, {
      title: {
        text: '<%= @infos_data[1]["title"] %>',
        style: {
          color: Highcharts.getOptions().colors[1]
        }
      },
      labels: {
        style: {
          color: Highcharts.getOptions().colors[1]
        }
      },
      opposite: true
    }, {
      title: {
        text: '<%= @infos_data[2]["title"] %>',
        style: {
          color: Highcharts.getOptions().colors[2]
        }
      },
      labels: {
        style: {
          color: Highcharts.getOptions().colors[2]
        }
      },
      opposite: true
    }],
    plotOptions: {
      spline: {
        marker: {
          enabled: true
        }
      },
      pie: {
        allowPointSelect: false,
        dataLabels: {
          enabled: false,
          format: '<b>{point.name}</b><br>{point.y}',
        }
      }
    },
    tooltip: {
      headerFormat: '<b>{series.name}</b><br>',
      pointFormat: '{point.x: %Y}:  {point.y: .1f}',
      formatter: function() {
        var s;
        if (this.point.name) { // the pie chart
          return false;
        } else {
          var d = new Date(this.x);
          d = d.getFullYear();
          s = this.series.name + '<br>' + d + ': ' + this.y.toFixed(1);
        }
        return s;
      }
    },
    series: [{
      name: 'Endangered',
      type: 'pie',
      data: [{
        name: 'Extinct',
        y: <%= @threatened[0] %>
      }, {
        name: 'Threatened',
        y: <%= @threatened[1] %>
      }, {
        name: 'At Risk',
        y: <%= @threatened[2] %>
      }, {
        name: 'Data Deficient',
        y: <%= @threatened[3] %>
      }, {
        name: 'Least Concerned',
        y: <%= @threatened[4] %>
      }],
      center: ["20%", "10%"],
      size: 100,
      showInLegend: false,
      dataLabels: {
        enabled: true
      },
    }, {
      name: '<%= @infos_data[0]["title"] %>',
      yAxis: 0,
      type: "spline",
      data: <%= @infos_data[0]["data"] %>
    }, {
      name: '<%= @infos_data[1]["title"] %>',
      yAxis: 1,
      type: "spline",
      data: <%= @infos_data[1]["data"] %>
    }, {
      name: '<%= @infos_data[2]["title"] %>',
      yAxis: 2,
      type: "spline",
      data: <%= @infos_data[2]["data"] %>
    }]
  });
});
</script>
